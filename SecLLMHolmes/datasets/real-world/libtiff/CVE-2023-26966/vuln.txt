The function `uv_encode` does not check for the NaN values of `u` and `v` in the start before using them for encoding, this can cause them to exceed the bound of the buffer causing an out-of-bound vulnerability.