The function `TIFFClose` checks for NULL value of `tif` before calling `TIFFCleanup` on it, this will prevent a NULL pointer dereference.