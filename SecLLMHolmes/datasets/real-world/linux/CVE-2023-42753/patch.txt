The IP_SET_HASH_WITH_NET0 macro in the program lead to the use of right `CIDR_POS(c)` and correct calculation of the `h->nets` array offset, which prevents an integer underflow.