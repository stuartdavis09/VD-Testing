The function `l2cap_sock_release(sk)` frees `sk` as well as cleans sk so its children are not still alive and do not point to the already free'd sk's address. This prevents a use-after-free.