The program checks and increases the RX buffer size to 3K when the SBP bit is on, as the size of the RX buffer determines the number of pages allocated which may not be sufficient for receive frames larger than the set MTU size. This increase in buffer size will prevent an out-of-bound write.