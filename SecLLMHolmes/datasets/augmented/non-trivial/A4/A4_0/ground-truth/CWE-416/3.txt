If the connection fails then the program first frees the `file` memory and then tries to log the error using `error_log` function. However, `error_log` also uses the `file`, leading to a use after free attack.