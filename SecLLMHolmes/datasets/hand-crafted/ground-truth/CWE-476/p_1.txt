The user provided `file_path` is checked for null pointer. Additionally, the file pointer `fp` is also checked for null value, this prevents it from NULL pointer derefence attacks.