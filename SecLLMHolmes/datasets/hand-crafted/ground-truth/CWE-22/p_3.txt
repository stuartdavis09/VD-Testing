The code concatenates the environment variable `dir` and user input `file_name`. Then in `resolve_path` it replaces whitespaces with the ‘-’ and sanitizes for “..” or “%E2%E2” like path traversal entities by calling the function `realpath`. After returning to `print_file` it is passed to `fopen` and it prevents a path traversal attack.